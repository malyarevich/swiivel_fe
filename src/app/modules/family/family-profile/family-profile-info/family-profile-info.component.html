<app-spinner *ngIf="loader$ | async"></app-spinner>
<ng-container *ngIf="family">
  <!--Show profile info-->
  <app-family-profile-info-view *ngIf="!isEditProfile" [family]="family"
                                (isEditEmitter)="onEdit($event)"></app-family-profile-info-view>
  <!--End Show profile info-->

  <!--Edit profile info-->
  <form *ngIf="isEditProfile" [formGroup]="familyForm" (ngSubmit)="submit()">

    <!--Family Name-->
    <div class="row no-gutters">
      <div class="col-10">
        <p [hidden]="isEditFamilyName" class="app-text-extra-large font-weight-bold mb-0">
          {{familyForm.value.name}}</p>
        <input type="text"
               class="form-control w-75"
               autofocus
               formControlName="name"
               [hidden]="!isEditFamilyName"
               (blur)="isEditFamilyName = false"
               (keyup.enter)="isEditFamilyName = false"
               placeholder="Family Name">
      </div>

      <div class="col-2 pt-1">
        <i class="fas fa-trash fa-sm app-text-second mr-4 app-cursor-pointer"></i>
        <i class="fas fa-pen fa-sm app-text-second app-cursor-pointer" (click)="isEditFamilyName = true"></i>
      </div>
    </div>
    <!--End Family Name-->

    <!--Address-->
    <p class="font-weight-bold app-text-small mt-3 mb-1">ADDRESS</p>
    <div class="row no-gutters app-family-profile-section p-3">

      <div class="col-12 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">Home Address</label>
          <input
            type="text"
            class="app-input"
            formControlName="address">
        </div>
      </div>

      <div class="col-4 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">City</label>
          <input
            type="text"
            class="app-input"
            formControlName="city">
        </div>
      </div>

      <div class="col-4 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">State</label>
          <input
            type="text"
            class="app-input"
            formControlName="state">
        </div>
      </div>

      <div class="col-4 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">Zip Code</label>
          <input
            type="text"
            appNumbersValidator="true" regexStr="^[0-9]+$"
            class="app-input"
            formControlName="zip">
        </div>
      </div>

    </div>
    <!--End Address-->

    <!--Contacts-->
    <p class="font-weight-bold app-text-small mt-4 mb-1">CONTACTS</p>
    <div class="row no-gutters app-family-profile-section p-3">

      <div class="col-12 p-2">
        <div class="app-input-fill">
          <app-select-field
                            [formControlName]="'preferred_contact'"
                            id="preferred_contact"
                            labelTitle="Preferred Contact"
                            [items]="preferredContacts">
          </app-select-field>
        </div>
      </div>

      <div class="col-12 p-2">
        <div class="app-input-fill">
          <app-select-field class="app-text-capitalize"
                            [formControlName]="'preferred_contact_method'"
                            id="preferred_contact_method"
                            labelTitle="Preferred Contact Method"
                            [items]="contactMethod">
          </app-select-field>
        </div>
      </div>

      <div class="col-12 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">Home Phone Number</label>
          <input
            type="text"
            appNumbersValidator="true" regexStr="^[0-9]+$"
            class="app-input"
            formControlName="home_phone_number">
        </div>
      </div>

    </div>
    <!--End Contacts-->

    <!--Custom Fields-->
    <p class="font-weight-bold app-text-small mt-4 mb-1">CUSTOM FIELDS</p>
    <div class="row no-gutters app-family-profile-section p-3">

      <div class="col-12 p-2">
        <div class="app-input-fill">
          <app-select-field class="app-text-capitalize"
                            [formControlName]="'language_spoken_at_home'"
                            id="language_spoken_at_home"
                            labelTitle="Language Spoken at Home"
                            [items]="language">
          </app-select-field>
        </div>
      </div>

      <div class="col-6 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">Family Rabbi</label>
          <input
            type="text"
            class="app-input"
            formControlName="family_rabbi">
        </div>
      </div>

      <div class="col-6 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">Rabbi Phone number</label>
          <input
            type="text"
            appNumbersValidator="true" regexStr="^[0-9]+$"
            class="app-input"
            formControlName="rabbi_phone_number">
        </div>
      </div>

      <div class="col-12 p-2">
        <div class="app-input-fill">
          <label class="app-input-label app-family-profile-input">Family Shul</label>
          <input
            type="text"
            class="app-input"
            formControlName="family_shul">
        </div>
      </div>

    </div>
    <!--End Custom Fields-->

    <div class="row text-right mt-4">
      <div class="col-12">
        <button class="btn app-btn-warning px-4 mr-2" (click)="onEdit(false); $event.preventDefault()">Cancel</button>
        <button type="submit" [disabled]="!familyForm.valid" class="btn app-btn-primary px-4">Save</button>
      </div>
    </div>
  </form>
  <!--End Edit profile info-->
</ng-container>