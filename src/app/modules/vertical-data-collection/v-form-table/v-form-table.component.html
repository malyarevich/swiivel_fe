<div class="container-fluid mt-3">
  <h4 class="font-weight-bold">Form Builder</h4>
  <app-v-form-statistic></app-v-form-statistic>
  <div class="col-sm-12 block-wrapper mt-3">
    <app-v-form-nav (bulkActionEmitter)="doBulkAction($event)"
                    (searchValueEmitter)="setSearchValue($event)"
                    (filterStatusEmitter)="filterStatus($event)">
    </app-v-form-nav>

    <table class="table">
      <thead app-v-form-table-header [cols]="cols" (searchDataEmitter)="setSearch($event)"></thead>
      <tbody *ngIf="forms?.length!=0">
      <tr *ngFor="let item of forms" (click)="addSelectedIds(item.id)"
          [ngClass]="{'checked-row': isCheckedRow(item.id)}">
        <td>
          <a class="app-ft-reset-link" [routerLink]="'v-form-info/' + item.id">
            <span class="font-weight-bold">{{item.name}}</span>
          </a>
        </td>
        <td><span class="app-text-primary font-weight-bold">{{item.type | titlecase}}</span></td>
        <td>
          <ng-container *ngIf="item.permissions?.length">
            <span class="font-weight-bold"
                  *ngFor="let permission of item.permissions">{{permission.user.full_name}}  </span>
          </ng-container>
          <button type="button"
                  class="btn app-invite-btn"
                  data-toggle="modal"
                  data-target="#flipFlop"
                  (click)="formSelected = item.mongo_id">
            <span class="app-text-primary">+ Invite Users</span>
          </button>
          <app-v-form-access-modal (resetFormSelectedEmitter)="resetFormSelected($event)"
                                   [formSelected]="formSelected">
          </app-v-form-access-modal>
        </td>
        <td>
          <span class="font-weight-bold">{{item.owner.full_name}}</span>
          <span class="app-form-table-second-color"> {{ item.owner.role.role_name}}</span>
        </td>
        <td>{{convertDate(item.updated_at) | date:'dd-MM-yyyy'}}
          <span class="app-form-table-second-color"> {{convertDate(item.updated_at) | date:'shortTime'}}</span>
        </td>
        <td>
          <div ngbDropdown class="d-inline-block">

            <button type="button" class="btn app-btn-status px-1 py-0 app-dropdown-toggle"
                    [ngClass]="getClassByStatus(item.status)"
                    id="dropdownBasic1"
                    ngbDropdownToggle
                    appClickStopPropagation>
              <ng-template [ngIf]="item.status === STATUS_REVIEW" [ngIfElse]="chevron">
              <span>{{'In ' + item.status | titlecase}}
                <i class="fas fa-hourglass-start"></i>
              </span>
              </ng-template>
              <ng-template #chevron>
              <span>{{item.status | titlecase}}
                <i class="fas fa-chevron-down"></i>
              </span>
              </ng-template>
            </button>
            <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
              <button *ngFor="let status of statuses"
                      (click)="changeStatus(item.id, status)"
                      ngbDropdownItem
                      appClickStopPropagation>
                {{status | titlecase}}
              </button>
            </div>
          </div>
        </td>
        <td nowrap>
          <button type="button"
                  class="btn btn-secondary app-btn-primary app-btn-sml mr-2 "
                  routerLink="v-form-constructor/{{item.mongo_id}}"
                  routerLinkActive="active"
                  appClickStopPropagation>
            <span><i class="fas fa-pen"></i> Edit</span>
          </button>
          <button type="button"
                  class="btn btn-secondary app-btn-primary app-btn-sml mr-2 "
                  routerLink="onlineform/{{item.mongo_id}}"
                  routerLinkActive="active"
                  appClickStopPropagation>
            <span><i class="far fa-eye"></i> View</span>
          </button>
          <button type="button"
                  class="btn btn-outline-danger app-btn-sml mr-2 "
                  (click)="removeForm(item.mongo_id)"
                  appClickStopPropagation>
            <span><i class="fas fa-trash-alt"></i> Delete</span>
          </button>
          <button appClickStopPropagation
                  class="btn app-btn-sml mr-2 ">
            <span class="app-form-table-icon"><i class="fas fa-share-alt"></i></span>
          </button>
          <button appClickStopPropagation
                  class="btn app-btn-sml mr-2 ">
            <span class="app-form-table-icon"><i class="fas fa-share"></i></span>
          </button>
          <button appClickStopPropagation
                  class="btn app-btn-sml mr-2 ">
            <span class="app-form-table-icon"><i class="fas fa-copy"></i></span>
          </button>
          <button appClickStopPropagation
                  class="btn app-btn-sml ">
            <span class="app-form-table-icon"><i class="fas fa-ellipsis-v"></i></span>
          </button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

