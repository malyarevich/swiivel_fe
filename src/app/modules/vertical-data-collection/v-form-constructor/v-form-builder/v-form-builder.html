<br>
<form class="form-inline">

  <button type="button" class="btn btn-outline-secondary text-uppercase form-control" (click)="goBack()">Back</button>
  <!--<div *ngIf="formName.length>3" class="justify-content-end">-->
  <div class="justify-content-end">
    <button type="button" class="btn btn-outline-secondary text-uppercase " (click)="saveForm()">Save</button>
  </div>


  <div *ngIf="warningVisible" class="alert alert-warning alert-dismissible col-md-4 col-md-offset-1">
    <a href="#" class="close" data-dismiss="alert" aria-label="close" (click)="disableWarning()">&times;</a>
    <strong>Warning! </strong>{{showWarningMessage}}
  </div>
</form>
<br>


<div class="row no-gutters">
  <div class="col-3 pl-5">

    <div class="row justify-content-center pb-2">

      <div class="col-10 bg-white ">

        <div class="  row no-gutters slider-item align-items-center">
          <div class="col-9">
            <span class="slider-item-header ">FORM FIELDS</span>
          </div>
          <div class="col">
            <label class="app-switch mr-2">
              <input type="checkbox" [(ngModel)]="isFormsFields">
              <span class="app-slider app-round"></span>
            </label>
          </div>
        </div>
        <div [hidden]="!isFormsFields" class="bg-white rounded mb-3">
          <input class="form-control mb-3 search-input" [(ngModel)]="searchText" placeholder="Search...">

          <div class="mb-2  " *ngFor="let sideBar of sideBarFields | filter : searchText">
            <app-v-side-bar-group
              *ngIf="sideBar.type==113"
              [group]="sideBar"
              [existingFields]="existingFields"
              [customFields]="customFields"
              (onDeleteNested)="onDelete($event)"
              (onChangeFieldBeing)="onChangeFieldBeing($event)"
              (onChangeGroupBeing)="onChangeGroupBeing($event, sideBar)"
            >

            </app-v-side-bar-group>
            <app-v-side-bar-field
              *ngIf="sideBar.type!=113"
              [field] ="sideBar"
              [style]="sideBar.mapped==''"
              (deleteCustom)="onDeleteCustom($event)"
              (onChangeFieldBeing)="onChangeFieldBeing($event)"

            >
            </app-v-side-bar-field>
          </div>
          <div>
            <button
              *ngIf="showAddButton"
              type="button"
              class="btn btn-outline-primary form-control p-0 text-left"
              (click)="showAddButton=false">
              &nbsp;&nbsp;+ Add New Field
            </button>
            <input
              *ngIf="!showAddButton"
              (keyup)="nameChange($event)"
              [ngClass]="!validNewCustomFieldName?'is-invalid':''"
              class="form-control add-input p-0"
              autofocus
              #newField
              (blur)="addNewCustomField(newField.value, sideBarFields); newField.value=''"
              (keyup.enter)="addNewCustomField(newField.value, sideBarFields); newField.value=''">
            <div class="invalid-feedback">
              We have existing field with the same name!
            </div>
          </div>

        </div>

      </div>

    </div>

    <div class="row justify-content-center pb-2">
      <div class="col-10 bg-white slider-item  row no-gutters align-items-center">
        <div class="col-9">
          <span class="slider-item-header ">DOCUMENTS & FORMS</span>
        </div>
        <div class="col">
          <label class="app-switch mr-2">
            <input type="checkbox">
            <span class="app-slider app-round"></span>
          </label>
        </div>
      </div>
    </div>

    <div class="row justify-content-center pb-2">
      <div class="col-10 bg-white slider-item  row no-gutters align-items-center">
        <div class="col-9">
          <span class="slider-item-header ">CONSENT</span>
        </div>
        <div class="col">
          <label class="app-switch mr-2">
            <input type="checkbox">
            <span class="app-slider app-round"></span>
          </label>
        </div>
      </div>
    </div>

    <!--TUITION CONTRACT-->
    <div class="row justify-content-center pb-2">
      <div class="col-10 bg-white ">
        <div class="  row no-gutters slider-item align-items-center">
          <div class="col-9">
            <span class="slider-item-header ">TUITION CONTRACT</span>
          </div>
          <div class="col">
            <label class="app-switch mr-2">
              <input type="checkbox" [(ngModel)]="isTuitionContract">
              <span class="app-slider app-round"></span>
            </label>
          </div>
        </div>
        <div [hidden]="!isTuitionContract" class="bg-white rounded mb-3">
          <p class="mt-3 font-weight-bold">Table Structure</p>
          <div class="row no-gutters">
            <div class="col">
              <label class="app-radio-container">Split by Student
                <input type="radio" name="split" value="student" [(ngModel)]="splitTuitionBy">
                <span class="app-radio-checkmark"></span>
              </label>
            </div>
            <div class="col">
              <label class="app-radio-container">Split by Fee
                <input type="radio" name="split" value="fee" [(ngModel)]="splitTuitionBy">
                <span class="app-radio-checkmark"></span>
              </label>
            </div>
          </div>
          <hr>
          <p class="font-weight-bold">Show Fees</p>
          <div class="row no-gutters">
            <div class="col-6">
              <label class="app-checkbox-container">
                BAIS MEDRASH WINTER DORMITORY FEE
                <input type="checkbox" [(ngModel)]="showFee.dormitory">
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
            <div class="col" *ngIf="splitTuitionBy === 'student'">
              <label class="app-switch app-switch-top-0 mr-1">
                <input type="checkbox" [disabled]="!showFee.dormitory" [(ngModel)]="showFeeDiscounts.dormitory">
                <span class="app-slider app-round"></span>
              </label>
              <span>Show Discounts</span>
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-6">
              <label class="app-checkbox-container">
                REGISTRATION
                <input type="checkbox" [(ngModel)]="showFee.registration">
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
            <div class="col" *ngIf="splitTuitionBy === 'student'">
              <label class="app-switch app-switch-top-0 mr-1">
                <input type="checkbox" [disabled]="!showFee.registration" [(ngModel)]="showFeeDiscounts.registration">
                <span class="app-slider app-round"></span>
              </label>
              <span>Show Discounts</span>
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-6">
              <label class="app-checkbox-container">
                ACTIVITY
                <input type="checkbox" [(ngModel)]="showFee.activity">
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
            <div class="col" *ngIf="splitTuitionBy === 'student'">
              <!--<label class="app-switch app-switch-top-0 mr-1">-->
                <!--<input type="checkbox" [disabled]="!showFee.activity" [(ngModel)]="showFeeDiscounts.activity">-->
                <!--<span class="app-slider app-round"></span>-->
              <!--</label>-->
              <!--<span>Show Discounts</span>-->
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-6">
              <label class="app-checkbox-container">
                TUITION
                <input type="checkbox" [(ngModel)]="showFee.tuition">
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
            <div class="col" *ngIf="splitTuitionBy === 'student'">
              <label class="app-switch app-switch-top-0 mr-1">
                <input type="checkbox" [disabled]="!showFee.tuition" [(ngModel)]="showFeeDiscounts.tuition">
                <span class="app-slider app-round"></span>
              </label>
              <span>Show Discounts</span>
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-6">
              <label class="app-checkbox-container">
                SCHOLARSHIP
                <input type="checkbox"  [(ngModel)]="showFee.scholarship">
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
            <div class="col" *ngIf="splitTuitionBy === 'student'">
              <label class="app-switch app-switch-top-0 mr-1">
                <input type="checkbox" [disabled]="!showFee.scholarship" [(ngModel)]="showFeeDiscounts.scholarship">
                <span class="app-slider app-round"></span>
              </label>
              <span>Show Discounts</span>
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-6">
              <label class="app-checkbox-container">
                LUNCH FEE
                <input type="checkbox" [(ngModel)]="showFee.lunch">
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
            <div class="col" *ngIf="splitTuitionBy === 'student'">
              <label class="app-switch app-switch-top-0 mr-1">
                <input type="checkbox"  [disabled]="!showFee.lunch" [(ngModel)]="showFeeDiscounts.lunch">
                <span class="app-slider app-round"></span>
              </label>
              <span>Show Discounts</span>
            </div>
          </div>
          <hr>
          <div class="  row no-gutters slider-item align-items-center">
            <div class="col">
              <label class="app-switch mr-2">
                <input type="checkbox" [(ngModel)]="isContractSignature">
                <span class="app-slider app-round"></span>
              </label>
              <span class="font-weight-bold ">Contract Signature</span>
            </div>
          </div>
          <ng-container *ngIf="isContractSignature">
            <div class="row no-gutters">
              <div class="btn-group btn-group-toggle w-100 mt-2"
                   ngbRadioGroup
                   name="radioSignature"
                   ngModel
                   [ngModelOptions]="{standalone: true}">
                <label ngbButtonLabel class="btn app-btn-signature">
                  <input ngbButton type="radio" value="eSign"> E-signature
                </label>
                <label ngbButtonLabel class="btn app-btn-signature">
                  <input ngbButton type="radio" value="wetSign"> Wet Signature
                </label>
              </div>
            </div>
            <div class="row no-gutters app-tuition-signature px-3 pt-3">
              <div class="col">
                <label class="app-radio-container">System
                  <input type="radio" name="signatureType" value="student">
                  <span class="app-radio-checkmark"></span>
                </label>
              </div>
              <div class="col">
                <label class="app-radio-container">External
                  <span class="pl-2"><i class="fas fa-cog app-gear"></i></span>
                  <input type="radio" name="signatureType" value="fee">
                  <span class="app-radio-checkmark"></span>
                </label>
              </div>
            </div>
            <div class="row px-3 pt-3">
              <label class="app-checkbox-container">
                Both Parents' Signature (when applicable)
                <input type="checkbox" ngModel>
                <span class="app-checkbox-checkmark"></span>
              </label>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    <!--END TUITION CONTRACT-->

    <div class="row justify-content-center pb-2">
      <div class="col-10 bg-white slider-item  row no-gutters align-items-center">
        <div class="col-9">
          <span class="slider-item-header ">PAYMENT SETTINGS</span>
        </div>
        <div class="col">
          <label class="app-switch mr-2">
            <input type="checkbox">
            <span class="app-slider app-round"></span>
          </label>
        </div>
      </div>
    </div>


<!--    FORM PAYMENT-->
    <div class="row justify-content-center pb-2">
      <div class="col-10 bg-white ">
        <div class="  row no-gutters slider-item align-items-center">
          <div class="col-9">
            <span class="slider-item-header ">FORM PAYMENT</span>
          </div>
          <div class="col">
            <label class="app-switch mr-2">
              <input type="checkbox" [(ngModel)]="isFormPayment">
              <span class="app-slider app-round"></span>
            </label>
          </div>
        </div>
        <div [hidden]="!isFormPayment" class="bg-white rounded mb-3 " >
        <div class="row no-gutters pt-2 align-items-center" *ngFor="let item of formPaymentSideBar">
          <div class="col-1">
          <label class="app-checkbox-container">
            <input
              type="checkbox" [(ngModel)]="item.isActive">
            <span class="app-checkbox-checkmark"></span>
          </label>
          </div>
          <div class="col ">
            <span class="form-payment-side-bar-text">{{item.name}}</span>
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>

  <!--  END  FORM PAYMENT-->

  <div class="col-9 pr-5">

    <div
      cdkDropList
      id="workPlaceList"
      [cdkDropListData]="fields"
      [cdkDropListConnectedTo]="['ExistingFieldsList', 'CustomFieldsList', '6372c882-3d14-486f-9c1f-52ae8ab928ef']"
      (cdkDropListDropped)="drop($event)">
      <ul class="list-group" [hidden]="!isFormsFields">
        <li class="list-group-item mb-3" *ngFor="let field of fields; trackBy: trackByFn" cdkDrag cdkDragLockAxis="y"
            [ngClass]="[!field.isValidName||!field.isValid?'list-group-item-warning':'', field.type==113?'app-list-group-item-info':'']">
          <app-v-group-container *ngIf="field.type==113" [inputGroup]="field" [customFields]="customFields"></app-v-group-container>
          <app-v-field-container *ngIf="field.type!=113"
                                 [customFields]="customFields"
                                 [inputField]="field"
                                 (onChange)="onChange($event, field)"
                                 (onUniq)="onUniq($event)"
                                 (onDelete)="onDelete($event)"
                                 (onFieldChanged)="onFieldChanged($event)">
          </app-v-field-container>
        </li>

      </ul>
      <div class="app-section-wrapper" [hidden]="!isTuitionContract">
        <app-v-tuition-contract
          [splitTuitionBy]="splitTuitionBy"
          [showFee]="showFee"
          [showFeeDiscounts]="showFeeDiscounts">
        </app-v-tuition-contract>
      </div>
      <div class="app-section-wrapper" [hidden]="!isFormPayment">
      <app-v-form-payment [formPaymentSideBar]="formPaymentSideBar">
<!--      <app-v-form-payment>-->

      </app-v-form-payment>
      </div>
    </div>
  </div>
</div>



